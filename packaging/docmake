
# The subdirectory where the overview.html file is located.
STEM=org/log4j

. .functions

WINDOWTITLE="Log4j version 0.8.5"
DOCTITLE="Log4j version 0.8.5<br>Package Overview"
HEADER="<b>Log4j 0.8.5</b><br>by <A HREF=mailto:cgu@freesurf.ch>Ceki G&uuml;lc&uuml;</A></b>"
#BOTTOM="IBM Zurich Research Laboratory"
BOTTOM="Copyright 1996-2000, IBM Corporation and others. All rights reserved.<br>Copyright 2000, Ceki G&uuml;lc&uuml;. All rights reserved."



# The Link to rest of JDK documentation
JAVADOC_URL="http://java.sun.com/products/jdk/1.2/docs/api"
GROUPCORE1="User Relevant Packages"
GROUPCORE2="org.log4j:org.log4j.net:org.log4j.nt:org.log4j.xml"
GROUPTEST1="Example, Test & Performance measuring Packages"
GROUPTEST2="org.log4j.examples:org.log4j.xml.examples:org.log4j.test:org.log4j.performance:org.log4j.xml.test"
GROUPEXT1="Internal Helper Packages"
GROUPEXT2="org.log4j.helpers"

#SRCDIR="/java/jdk/1.2/src/share/classes"

pushd $PWD > /dev/null

scriptDir=$(getShellScriptDirectory)
echo "Script directry is determined to be [$scriptDir]"

PKG_DIR=${scriptDir%/packaging}
JDK_PACKAGE_LIST="$scriptDir/package-list"
JDK_PACKAGE_LIST_DIR="$scriptDir"

LOCAL_PACKAGE_LIST="$scriptDir/local-package-list"

if [ ! -d $PKG_DIR ]
then
  echo "Directory [$PKG_DIR] does not exist."
  exit 1
fi

changeFileExtension $PKG_DIR/org/log4j/UnitTestCategory.java avaj
changeFileExtension $PKG_DIR/org/log4j/helpers/UnitTestOptionConverter.java avaj

if [ -z "$JAVADOC" ]
then
  echo "Will attempt to use standard javadoc."
  JAVADOC=javadoc
fi

if [ ! -s  $JDK_PACKAGE_LIST ]
then
  echo "Could not find file [$JDK_PACKAGE_LIST]."
  echo "This file is needed to link with the rest of JDK Documentation."
  exit 1
fi

if [ ! -s $LOCAL_PACKAGE_LIST ]
then
  echo "Could not find file [$LOCAL_PACKAGE_LIST]."
  echo "This file contains the list of packages to document."
  exit 1
fi

cd $PKG_DIR


if [ ! -s $PKG_DIR/packaging/package-list ]
then
  echo "Could not find file \"package-list\" in directory $PKG_DIR/packaging."
  echo "This file is needed to link with the rest of JDK Documentation."
  echo "Current direcotry is [$PWD]."
  exit 1
fi

pwd
if [ -z "$FIND" ] 
then
 echo "FIND not set." 
 FIND=find
fi

if [ "$1" = "-u" ]
then
  shift	
  type find
  echo "About to search for packages under [$PWD]"
  echo "Found packages are ==========="
  $FIND . -name \*.java -exec dirname {} \; \
   | sort | uniq | sed -e 's/^\.\///' -e 's/\//\./g' | tee $LOCAL_PACKAGE_LIST
  echo "=============================="
fi

if [ "$1" = "-k" ]
then
  shift	
  type find
  echo "About to search for packages under [$PWD]"
  echo "Found packages are ==========="
  $FIND . -type f -name \*.java  -not \( -path '*doc-files*'\
  -o -path '*pending*' \
  -o -path '*Test*' \
  -o -path '*misc*' -o -path '*make*' \
  -o -path '*test*' \)  | tee $LOCAL_PACKAGE_LIST
  echo "=============================="
fi

if [ $# = 0 ]
then
$JAVADOC  \
 -sourcepath  $PKG_DIR \
 -d javadoc \
 -linkoffline $JAVADOC_URL $JDK_PACKAGE_LIST_DIR \
 -overview    $PKG_DIR/$STEM/overview.html \
 -doctitle    "$DOCTITLE" \
 -header      "$HEADER" \
 -bottom      "$BOTTOM" \
 -group       "$GROUPCORE1" "$GROUPCORE2" \
 -group       "$GROUPTEST1" "$GROUPTEST2" \
 -group       "$GROUPEXT1" "$GROUPEXT2" \
 -author \
 -version\
 -public\
  @$LOCAL_PACKAGE_LIST

# -package\
     
else
  echo "Generating javadoc files"
$JAVADOC  \
 -sourcepath  $PKG_DIR \
 -d update \
 -linkoffline . javadoc\
 -doctitle    "$DOCTITLE" \
 -header      "$HEADER" \
 -bottom      "$BOTTOM" \
 -author \
 -version\
 -public\
  $*
  
  for pkg in $*
  do
    pkgDir=$(echo $pkg |sed -e 's/\./\//g')
    echo "Copying:   update/$pkgDir/ --> javadoc/$pkgDir/"
    cp update/$pkgDir/* javadoc/$pkgDir/
  done 
fi

popd > /dev/null


changeFileExtension $PKG_DIR/org/log4j/UnitTestCategory.avaj java
changeFileExtension $PKG_DIR/org/log4j/helpers/UnitTestOptionConverter.avaj java



	
